<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/css" href="/theme/custom.css"?>
<svg viewBox="0 0 600 350" xmlns="http://www.w3.org/2000/svg">
    <title>Fold Step Diagram</title>
    <desc>
        Diagram illustrating the 'fold' step:
        - Shows walker elements V1(age=30), V2(age=25), V3(age=40).
        - An accumulator box starts with an initial value (0).
        - Arrows show each element being processed with the accumulator.
        - The accumulator updates: 0 -> 30 (V1) -> 55 (V2) -> 95 (V3).
        - A final result box shows the accumulated value (95).
        - Indicates that the traversal terminates after this step.
    </desc>
    <defs>
        <marker id="arrowhead-pointer" class="marker-arrowhead-pointer marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
    </defs>

    <text x="300" y="30" class="step-label" text-anchor="middle">Walker Step:
        <tspan class="code">fold()</tspan>
    </text>

    <!-- Walker State (Vertices) -->
    <text x="150" y="60" class="text-color-muted" text-anchor="middle">Traversal Elements</text>
    <g class="node highlighted" transform="translate(50, 100)">
        <circle r="20"></circle>
        <text class="node-label">V1</text>
        <text class="property-text" y="30">age=30</text>
    </g>
    <g class="node highlighted" transform="translate(150, 100)">
        <circle r="20"></circle>
        <text class="node-label">V2</text>
        <text class="property-text" y="30">age=25</text>
    </g>
    <g class="node highlighted" transform="translate(250, 100)">
        <circle r="20"></circle>
        <text class="node-label">V3</text>
        <text class="property-text" y="30">age=40</text>
    </g>

    <!-- Accumulator Box -->
    <g transform="translate(150, 230)">
        <rect class="index-box" x="-100" y="-50" width="200" height="100"/>
        <text class="index-title" y="-35">Accumulator (acc)</text>
        <text class="index-value range" y="-15">Initial: 0</text>
        <text class="index-value range" y="0">V1: 0 + 30 = 30</text>
        <text class="index-value range" y="15">V2: 30 + 25 = 55</text>
        <text class="index-value range" y="30">V3: 55 + 40 = 95</text>
    </g>

    <!-- Arrows to Accumulator -->
    <path class="scan-pointer" d="M 50 130 q 25 50 50 80" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <path class="scan-pointer" d="M 150 130 q 0 50 0 80" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <path class="scan-pointer" d="M 250 130 q -25 50 -50 80" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <text x="150" y="160" class="text-color-muted" font-size="12px" text-anchor="middle">fold(0, |acc, v| acc + v.age)
    </text>


    <!-- Final Result -->
    <text x="450" y="180" class="text-color-muted" text-anchor="middle">Result</text>
    <g transform="translate(450, 230)">
        <rect class="index-box" x="-40" y="-20" width="80" height="40"/>
        <text class="index-title" y="-5">Result</text>
        <text class="index-value range" y="15">95</text>
    </g>
    <line class="step-arrow" x1="250" y1="230" x2="410" y2="230" marker-end="url(#arrowhead-pointer)"/>
    <text x="450" y="280" class="text-color-muted" font-size="12px" text-anchor="middle">Terminates Traversal</text>

</svg>
