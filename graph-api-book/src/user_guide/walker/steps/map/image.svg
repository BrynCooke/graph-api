<?xml-stylesheet type="text/css" href="../../../../css/images.css"?>
<svg width="650" height="400" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>Map Step Diagram</title>
    <desc>Diagram illustrating the 'map' step transforming graph elements into other values.</desc>

    <defs>
        <!-- Marker Definitions -->
        <marker id="arrowhead" class="marker-arrowhead marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
        <marker id="arrowhead-pointer" class="marker-arrowhead-pointer marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
        <marker id="arrowhead-path" class="marker-arrowhead-path marker-base" markerWidth="10" markerHeight="7"
                refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L10,3.5 L0,7 Z"/>
        </marker>
    </defs>

    <!-- === Graph Structure === -->
    <g id="graph" transform="translate(120, 70)">
        <!-- Vertices (highlighted as part of traversal) -->
        <g class="node highlighted" id="node-A" transform="translate(80, 50)">
            <circle r="20"></circle>
            <text class="node-label">A</text>
        </g>
        
        <g class="node highlighted" id="node-B" transform="translate(240, 50)">
            <circle r="20"></circle>
            <text class="node-label">B</text>
        </g>
        
        <g class="node highlighted" id="node-C" transform="translate(400, 50)">
            <circle r="20"></circle>
            <text class="node-label">C</text>
        </g>
        
        <!-- Edges -->
        <g class="edge" id="edge-A-B">
            <line x1="100" y1="50" x2="220" y2="50"></line>
        </g>
        <g class="edge" id="edge-B-C">
            <line x1="260" y1="50" x2="380" y2="50"></line>
        </g>
    </g>

    <!-- === Map Function Box === -->
    <g id="map-function" transform="translate(150, 180)">
        <rect x="0" y="0" width="320" height="60" rx="5" ry="5" 
              fill="var(--accent-primary)" fill-opacity="0.15" 
              stroke="var(--accent-primary)" stroke-width="1.5"/>
        <text x="160" y="25" text-anchor="middle" font-weight="bold" fill="var(--accent-primary)">Map Function</text>
        <text class="code" x="160" y="45" text-anchor="middle">|vertex, ctx| â†’ vertex.name</text>
    </g>

    <!-- === Arrows from Vertices to Map Function === -->
    <path d="M 200 140 L 200 180" class="step-arrow" marker-end="url(#arrowhead-pointer)"/>
    <path d="M 360 140 L 360 180" class="step-arrow" marker-end="url(#arrowhead-pointer)"/>
    <path d="M 520 140 L 520 180" class="step-arrow" marker-end="url(#arrowhead-pointer)"/>

    <!-- === Results Box === -->
    <g id="results" transform="translate(130, 290)">
        <rect x="0" y="0" width="360" height="80" rx="5" ry="5" 
              fill="var(--accent-secondary)" fill-opacity="0.15" 
              stroke="var(--accent-secondary)" stroke-width="1.5"/>
        <text x="180" y="25" text-anchor="middle" font-weight="bold" fill="var(--accent-secondary)">Iterator&lt;String&gt;</text>
        <text x="180" y="50" text-anchor="middle" font-family="monospace" fill="var(--accent-secondary)">
            "Project A", "Person B", "Project C"
        </text>
    </g>

    <!-- === Arrow from Map Function to Results === -->
    <path d="M 310 240 L 310 290" class="step-arrow" marker-end="url(#arrowhead-pointer)"/>

    <!-- === Step Explanation === -->
    <text class="step-label" x="325" y="30">Before map() step: Vertices in traversal</text>
    <text class="step-label" x="325" y="390">After map(): Traversal produces iterator of transformed values</text>
</svg>