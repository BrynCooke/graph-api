<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/css" href="/theme/custom.css"?>
<svg viewBox="0 0 600 350" xmlns="http://www.w3.org/2000/svg">
    <title>Map Step Diagram</title>
    <desc>
        Diagram illustrating the 'map' step:
        - Shows walker elements A, B, C highlighted.
        - A "Map Function" box shows the transformation logic (e.g., `|v| v.name`).
        - Arrows point from each element to the map function.
        - An arrow points from the map function to a "Rust Iterator" box.
        - The iterator box shows the transformed values ("NameA", "NameB", "NameC").
        - Indicates that the traversal terminates and returns an iterator.
    </desc>
    <defs>
        <!-- Marker Definitions -->
        <marker id="arrowhead" class="marker-arrowhead marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
        <marker id="arrowhead-pointer" class="marker-arrowhead-pointer marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
        <marker id="arrowhead-path" class="marker-arrowhead-path marker-base" markerWidth="10" markerHeight="7"
                refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L10,3.5 L0,7 Z"/>
        <marker id="arrowhead-pointer" class="marker-arrowhead-pointer marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
    </defs>

    <text x="300" y="30" class="step-label halo" text-anchor="middle">Walker Step: <tspan class="code">map()</tspan></text>

    <!-- Walker State (Vertices) -->
    <text x="150" y="60" class="text-color-muted" text-anchor="middle">Walker State</text>
    <g class="node highlighted" transform="translate(50, 100)">
        <circle r="20"></circle><text class="node-label">A</text>
    </g>
    <g class="node highlighted" transform="translate(150, 100)">
        <circle r="20"></circle><text class="node-label">B</text>
    </g>
    <g class="node highlighted" transform="translate(250, 100)">
        <circle r="20"></circle><text class="node-label">C</text>
    </g>

    <!-- Map Function Box -->
    <g id="map-function" transform="translate(150, 180)">
        <rect x="-100" y="-30" width="200" height="60" rx="5" ry="5"
              fill="var(--accent-primary)" fill-opacity="0.15"
              stroke="var(--accent-primary)" stroke-width="1.5"/>
        <text x="0" y="-5" text-anchor="middle" font-weight="bold" fill="var(--accent-primary)">Map Function</text>
        <text class="code" x="0" y="15" text-anchor="middle">|v, _| v.name()</text>
    </g>

    <!-- Arrows from Vertices to Map Function -->
    <path d="M 50 120 q 50 30 100 40" class="step-arrow" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <path d="M 150 120 q 0 30 0 40" class="step-arrow" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <path d="M 250 120 q -50 30 -100 40" class="step-arrow" marker-end="url(#arrowhead-pointer)" fill="none"/>

    <!-- Results Box -->
    <text x="450" y="130" class="text-color-muted" text-anchor="middle">Result</text>
    <g id="results" transform="translate(450, 180)">
        <rect x="-120" y="-40" width="240" height="80" rx="5" ry="5"
              fill="var(--accent-secondary)" fill-opacity="0.15"
              stroke="var(--accent-secondary)" stroke-width="1.5"/>
        <text x="0" y="-15" text-anchor="middle" font-weight="bold" fill="var(--accent-secondary)">Iterator&lt;String&gt;</text>
        <text x="0" y="10" text-anchor="middle" font-family="monospace" fill="var(--accent-secondary)">
            "NameA", "NameB", "NameC"
        </text>
    </g>

    <!-- Arrow from Map Function to Results -->
    <path d="M 250 180 q 75 0 120 0" class="step-arrow" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <text x="450" y="250" class="text-color-muted" font-size="12px" text-anchor="middle">Terminates Walker</text>

</svg>
