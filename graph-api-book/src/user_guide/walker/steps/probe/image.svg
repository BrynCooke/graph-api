<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/css" href="/theme/custom.css"?>
<svg viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
    <title>Probe Step Diagram</title>
    <desc>
        Diagram illustrating the 'probe' step:
        - Shows a walker traversing elements V1, V2, V3.
        - The 'probe()' step is inserted in the traversal chain.
        - Dashed arrows point from each element to a "Side Effect (Log)" box.
        - The side effect box shows example log output for each element.
        - The traversal continues to the next step unaffected by the probe.
    </desc>
    <defs>
        <marker id="arrowhead" class="marker-arrowhead marker-base" markerWidth="8" markerHeight="6" refX="7" refY="3"
                orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
        <marker id="arrowhead-pointer" class="marker-arrowhead-pointer marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
    </defs>

    <text x="300" y="30" class="step-label halo" text-anchor="middle">Walker Step: <tspan class="code">probe()</tspan></text>

    <!-- Walker State -->
    <text x="180" y="60" class="text-color-muted" text-anchor="middle">Walker Traversal</text>
    <g class="node highlighted" transform="translate(80, 100)">
        <circle r="20"></circle><text class="node-label">V1</text>
    </g>
    <g class="node highlighted" transform="translate(180, 100)">
        <circle r="20"></circle><text class="node-label">V2</text>
    </g>
    <g class="node highlighted" transform="translate(280, 100)">
        <circle r="20"></circle><text class="node-label">V3</text>
    </g>
    <line class="edge directed path" x1="100" y1="100" x2="160" y2="100" marker-end="url(#arrowhead)"/>
    <line class="edge directed path" x1="200" y1="100" x2="260" y2="100" marker-end="url(#arrowhead)"/>
    <line class="edge directed path" x1="300" y1="100" x2="360" y2="100" marker-end="url(#arrowhead)"/>
    <text x="400" y="105" class="text-color-muted" font-size="12px">Traversal continues...</text>


    <!-- Side Effect Box -->
    <g transform="translate(300, 220)">
        <rect class="index-box" x="-150" y="-35" width="300" height="70" stroke-dasharray="3 3"/>
        <text class="index-title" y="-20">Side Effect (e.g., Log)</text>
        <text class="index-value range" y="0" font-family="monospace">Processing V1...</text>
        <text class="index-value range" y="15" font-family="monospace">Processing V2...</text>
        <text class="index-value range" y="30" font-family="monospace">Processing V3...</text>
    </g>

    <!-- Arrows to Side Effect Box -->
    <path class="scan-pointer" d="M 80 120 q 0 50 70 85" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <path class="scan-pointer" d="M 180 120 q 0 65 0 85" marker-end="url(#arrowhead-pointer)" fill="none"/>
    <path class="scan-pointer" d="M 280 120 q 0 50 -70 85" marker-end="url(#arrowhead-pointer)" fill="none"/>

</svg>
