<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/css" href="/theme/custom.css"?>
<svg viewBox="0 0 600 480" xmlns="http://www.w3.org/2000/svg"> <!-- Increased height -->
    <title>Detour Step Diagram</title>
    <desc>
        Diagram illustrating the 'detour' step:
        - Before: Shows the main walker path at vertex A.
        - During: Shows the detour sub-walker exploring A -> D -> E.
        - After: Shows the main walker resuming at E (the result of the detour).
    </desc>
    <defs>
        <marker id="arrowhead" class="marker-arrowhead marker-base" markerWidth="8" markerHeight="6" refX="7" refY="3"
                orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
        <marker id="arrowhead-pointer" class="marker-arrowhead-pointer marker-base" markerWidth="8" markerHeight="6"
                refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L8,3 L0,6 Z"/>
        </marker>
    </defs>

    <!-- Step Representation (Left) -->
    <g id="step-representation" class="step-label" transform="translate(30, 220)"> <!-- Centered vertically -->
        <text x="0" y="-10" text-anchor="start" font-size="var(--font-size-small)">walker</text>
        <text class="code" x="10" y="10" text-anchor="start" font-size="var(--font-size-small)">
            .detour(|sub| sub...)
        </text>
    </g>

    <!-- Before detour() step (Top Right) -->
    <g id="before-step" transform="translate(200, 20)">
        <text class="step-label" x="150" y="0" text-anchor="middle">Before detour()</text>
        <g class="node highlighted" id="node-A-before" transform="translate(150, 50)">
            <circle r="20"></circle>
            <text class="node-label">A</text>
        </g>
        <g class="node" id="node-B-before" transform="translate(300, 50)">
            <circle r="20"></circle>
            <text class="node-label">B</text>
        </g>
        <line class="edge directed path" x1="170" y1="50" x2="280" y2="50" marker-end="url(#arrowhead)"/>
    </g>

    <!-- During detour() step (Middle Right) -->
    <g id="during-step" transform="translate(200, 160)">
        <text class="step-label" x="150" y="0" text-anchor="middle">During detour()</text>
        <!-- Detour Sub-Walker Box -->
        <g transform="translate(150, 50)">
            <rect class="index-box" x="-120" y="-30" width="240" height="80" stroke-dasharray="5 3"/>
            <text class="index-title" y="-15">Detour Sub-Walker</text>
            <g class="node" transform="translate(-80, 15)"> <!-- A (start of sub-walk) -->
                <circle r="15"></circle>
                <text class="node-label" font-size="10px">A</text>
            </g>
            <g class="node" transform="translate(0, 15)"> <!-- D -->
                <circle r="15"></circle>
                <text class="node-label" font-size="10px">D</text>
            </g>
            <g class="node highlighted" transform="translate(80, 15)"> <!-- E (result) -->
                <circle r="15"></circle>
                <text class="node-label" font-size="10px">E</text>
            </g>
            <line class="edge directed path" x1="-65" y1="15" x2="-15" y2="15" marker-end="url(#arrowhead)"/>
            <line class="edge directed path" x1="15" y1="15" x2="65" y2="15" marker-end="url(#arrowhead)"/>
        </g>
    </g>

    <!-- After detour() step (Bottom Right) -->
    <g id="after-step" transform="translate(200, 320)">
        <text class="step-label" x="150" y="0" text-anchor="middle">After detour()</text>
        <g class="node highlighted" id="node-E-after" transform="translate(150, 50)"> <!-- Result E -->
            <circle r="20"></circle>
            <text class="node-label">E</text>
        </g>
        <g class="node" id="node-F-after" transform="translate(300, 50)"> <!-- Next step -->
            <circle r="20"></circle>
            <text class="node-label">F</text>
        </g>
        <line class="edge directed path" x1="170" y1="50" x2="280" y2="50" marker-end="url(#arrowhead)"/>
        <text x="150" y="100" class="text-color-muted" font-size="12px" text-anchor="middle">Main walker resumes at E</text>
    </g>
</svg>
